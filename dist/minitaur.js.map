{"version":3,"file":"minitaur.js","sources":["../src/minitaur.js"],"sourcesContent":["/*!\n  minitaur v0.1.1 (https://github.com/kodie/minitaur)\n  by Kodie Grantham (https://kodieg.com)\n*/\n\nconst minitaur = (mount, options) => {\n  let elements = []\n  let modals = []\n\n  if (mount && mount.constructor === Object) {\n    options = mount\n    mount = null\n  }\n\n  options = minitaur.mergeObjects(minitaur.defaultOptions, options || {})\n\n  if (!mount) mount = options.mount\n\n  if (typeof mount === 'string') {\n    elements = document.querySelectorAll(mount)\n  } else if (mount instanceof HTMLElement) {\n    elements = [mount]\n  } else if (!mount) {\n    if (options.id) {\n      elements = [document.getElementById(options.id) || document.createElement('div')]\n    } else {\n      elements = [document.createElement('div')]\n    }\n  }\n\n  elements = minitaur.getModals(elements)\n\n  if (elements && elements.length) {\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (modal.minitaur) {\n          return true\n        }\n\n        if (options.beforeInit && options.beforeInit(modal) === false) {\n          return false\n        }\n\n        minitaur.modalCount++\n\n        let funcs = {\n          close: function (options) {\n            return minitaur.close(modal, options)\n          },\n          get: function (parseBreakpoints) {\n            return minitaur.get(modal, parseBreakpoints, false)\n          },\n          kill: function (putBack) {\n            return minitaur.kill(modal, putBack)\n          },\n          open: function (options) {\n            return minitaur.open(modal, options)\n          },\n          set: function (options, value) {\n            return minitaur.set(modal, options, value)\n          },\n          toggle: function (options) {\n            return minitaur.toggle(modal, options)\n          }\n        }\n\n        let opts = minitaur.parseOptions(minitaur.mergeObjects(options, minitaur.parseAttributes(modal.dataset), funcs, {\n          isOpen: false\n        }))\n\n        if (modal.parentNode && modal.parentNode !== document.body) {\n          opts.originalElement = modal.cloneNode(true)\n          opts.originalElementIndex = Array.prototype.indexOf.call(modal.parentNode.childNodes, modal)\n          opts.originalElementParent = modal.parentNode\n          modal.parentNode.removeChild(modal)\n        }\n\n        modal.minitaur = opts\n        modal.setAttribute('data-minitaur', '')\n\n        opts = minitaur.get(modal, true, false)\n\n        if (opts.id) {\n          modal.id = opts.id\n        } else if (!modal.id) {\n          modal.id = 'minitaur-' + minitaur.modalCount\n        }\n\n        if (window.minitaurDebug) console.log('minitaur.init (#' + modal.id + '):', opts)\n\n        if (opts.class) {\n          if (typeof opts.class === 'string') {\n            opts.class = [opts.class]\n          }\n\n          for (let c = 0; c < opts.class.length; c++) {\n            modal.classList.add(opts.class[c])\n          }\n        }\n\n        minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closeStyle || {}))\n        minitaur.initiateTriggers(modal)\n\n        if (!modal.parentNode) {\n          document.body.appendChild(modal)\n        }\n\n        if (opts.opened) {\n          modal.minitaur.open()\n        } else {\n          modal.minitaur.close()\n        }\n\n        if (opts.afterInit) {\n          options.afterInit(modal)\n        }\n\n        modals.push(modal)\n      })(elements[i])\n    }\n  }\n\n  if (!minitaur.initiated) {\n    minitaur.initiated = true\n\n    document.addEventListener('click', minitaur.documentClick)\n    window.addEventListener('resize', minitaur.documentResize)\n    window.addEventListener('scroll', minitaur.documentScroll)\n  }\n\n  if (modals.length) {\n    if (modals.length === 1) {\n      return modals[0]\n    }\n\n    return modals\n  }\n\n  return false\n}\n\nminitaur.initiated = false\nminitaur.modalCount = 0\n\nminitaur.defaultOptions = {\n  afterClose: null,\n  afterInit: null,\n  afterOpen: null,\n  anchor: null,\n  backdropClass: 'minitaur-backdrop',\n  backdropClosingStyle: null,\n  backdropOpeningStyle: null,\n  backdropStyle: {\n    backgroundColor: 'rgba(0, 0, 0, 0.5)'\n  },\n  beforeClose: null,\n  beforeInit: null,\n  beforeOpen: null,\n  breakpoints: null,\n  class: 'minitaur',\n  closeClass: 'closed',\n  closeDuration: 0,\n  closingClass: 'closing',\n  closingStyle: null,\n  closeOnFocusOut: true,\n  closeStyle: {\n    display: 'none',\n    visibility: 'hidden'\n  },\n  content: null,\n  id: null,\n  mount: '.minitaur, [data-minitaur]',\n  opened: false,\n  openClass: 'opened',\n  openDuration: 0,\n  openingClass: 'opening',\n  openingStyle: {\n    display: 'block',\n    visibility: 'visible'\n  },\n  openStyle: null,\n  parameters: null,\n  position: 'middle',\n  respectAnchorSpacing: false,\n  stayInBounds: true,\n  style: null,\n  takeover: false,\n  triggers: []\n}\n\nminitaur.clearTimers = function (modal) {\n  if (minitaur.resizeTimer) {\n    clearTimeout(minitaur.resizeTimer)\n    minitaur.resizeTimer = null\n  }\n\n  if (modal) {\n    if (modal.minitaur.closeDurationTimer) {\n      clearTimeout(modal.minitaur.closeDurationTimer)\n      modal.minitaur.closeDurationTimer = null\n    }\n\n    if (modal.minitaur.openDurationTimer) {\n      clearTimeout(modal.minitaur.openDurationTimer)\n      modal.minitaur.openDurationTimer = null\n    }\n  }\n}\n\nminitaur.close = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (options) modal.minitaur.set(options)\n\n      const opts = minitaur.get(modal, true, false)\n\n      if (window.minitaurDebug) console.log('minitaur.close (#' + modal.id + '):', opts)\n\n      minitaur.clearTimers(modal)\n\n      if (opts.beforeClose && opts.beforeClose(modal) === false) {\n        return false\n      }\n\n      modal.classList.remove(opts.openClass)\n      modal.classList.remove(opts.openingClass)\n      modal.classList.add(opts.closingClass)\n      minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closingStyle || {}))\n\n      let backdrop = null\n\n      if (opts.takeover) {\n        modal.removeAttribute('data-minitaur-taking-over')\n\n        backdrop = document.querySelector('[data-minitaur-backdrop=\"#' + modal.id + '\"]')\n\n        if (backdrop) {\n          backdrop.classList.remove(opts.openClass)\n          backdrop.classList.remove(opts.openingClass)\n          backdrop.classList.add(opts.closingClass)\n\n          const scrollX = parseInt(document.body.style.left || '0') * -1\n          const scrollY = parseInt(document.body.style.top || '0') * -1\n\n          minitaur.setStyle(backdrop, opts.backdropClosingStyle || {})\n\n          minitaur.setStyle(document.body, {\n            position: 'relative',\n            left: null,\n            top: null,\n            height: null,\n            width: null\n          })\n\n          window.scrollTo(scrollX, scrollY)\n        }\n      }\n\n      modal.minitaur.closeDurationTimer = setTimeout(function () {\n        modal.minitaur.isOpen = false\n\n        modal.classList.remove(opts.closingClass)\n        modal.classList.add(opts.closeClass)\n\n        if (opts.takeover && backdrop) {\n          document.body.removeChild(backdrop)\n          window.addEventListener('scroll', minitaur.documentScroll)\n        }\n\n        minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closeStyle || {}))\n\n        modal.dispatchEvent(new Event('close', { bubbles: true }))\n\n        if (opts.afterClose) {\n          opts.afterClose(modal)\n        }\n      }, opts.closeDuration || 0)\n    })(modals[i])\n  }\n}\n\nminitaur.documentClick = (e) => {\n  let element = e.target\n  let closeModals = true\n\n  do {\n    if (element === document.body) break\n    if (\n      element.minitaur ||\n      element.minitaurIgnore ||\n      element.classList.contains('minitaur-ignore')\n    ) closeModals = false\n  } while ((element = element.parentNode))\n\n  if (closeModals) {\n    const modals = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < modals.length; i++) {\n      let modal = modals[i]\n\n      if (modal.minitaur.closeOnFocusOut && modal.minitaur.isOpen === true) {\n        modal.minitaur.close()\n      }\n    }\n  }\n}\n\nminitaur.documentResize = (e) => {\n  minitaur.clearTimers()\n\n  minitaur.resizeTimer = setTimeout(function () {\n    const elements = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (modal.minitaur.isOpen) {\n          modal.minitaur.open()\n        }\n      })(elements[i])\n    }\n  }, 60)\n}\n\nminitaur.documentScroll = (e) => {\n  minitaur.clearTimers()\n\n  minitaur.resizeTimer = setTimeout(function () {\n    const elements = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        const opts = modal.minitaur\n\n        if (opts.isOpen && !opts.takeover && (opts.anchor.x === 'viewport' || opts.anchor.y === 'viewport')) {\n          modal.minitaur.open()\n        }\n      })(elements[i])\n    }\n  }, 60)\n}\n\nminitaur.get = (elements, parseBreakpoints, verify) => {\n  elements = minitaur.getModals(elements, verify)\n\n  let modals = []\n\n  for (let i = 0; i < elements.length; i++) {\n    (function (modal) {\n      let opts = minitaur.mergeObjects(modal.minitaur, { element: modal })\n\n      if (parseBreakpoints && opts.breakpoints) {\n        let breakpointOpts = null\n\n        for (let breakpoint in opts.breakpoints) {\n          if (document.documentElement.clientWidth >= parseInt(breakpoint)) {\n            breakpointOpts = opts.breakpoints[breakpoint]\n          }\n        }\n\n        if (breakpointOpts) {\n          opts = minitaur.mergeObjects(opts, breakpointOpts)\n        }\n\n        delete opts.breakpoints\n      }\n\n      modals.push(opts)\n    })(elements[i])\n  }\n\n  if (modals.length) {\n    if (modals.length === 1) {\n      return modals[0]\n    }\n\n    return modals\n  }\n\n  return false\n}\n\nminitaur.getModals = (elements, verify) => {\n  if (typeof elements === 'string') {\n    elements = document.querySelectorAll(elements)\n  } else if (elements instanceof HTMLElement) {\n    elements = [elements]\n  }\n\n  if (verify) {\n    let verifiedElements = []\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (!modal.minitaur) {\n          console.warn('Element doesn\\'t appear to be a minitaur instance:', modal)\n          return\n        }\n\n        verifiedElements.push(modal)\n      })(elements[i])\n    }\n\n    return verifiedElements\n  }\n\n  return elements\n}\n\nminitaur.initiateTriggers = (modals) => {\n  modals = minitaur.getModals(modals, true)\n\n  let actions = ['close', 'open', 'toggle']\n\n  for (let i = 0; i < modals.length; i++) {\n    const modal = modals[i]\n    let opts = minitaur.get(modal, true, false)\n    let triggers = opts.triggers || opts.trigger\n\n    if (typeof triggers === 'string') {\n      triggers = [{\n        action: 'toggle',\n        elements: triggers,\n        events: ['click']\n      }]\n    } else if (!triggers) {\n      triggers = []\n    }\n\n    triggers = triggers.reduce((validTriggers, trigger) => {\n      if (Array.isArray(trigger)) {\n        trigger.elements = trigger\n      } else if (!trigger.elements) {\n        console.warn('(minitaur: #' + modal.id + ') A trigger is missing it\\'s elements option.', trigger)\n        return validTriggers\n      }\n\n      validTriggers.push(trigger)\n      return validTriggers\n    }, [])\n\n    for (let t = 0; t < triggers.length; t++) {\n      let trigger = triggers[t]\n\n      if (typeof trigger === 'string') {\n        trigger = {\n          action: 'toggle',\n          elements: trigger,\n          events: ['click']\n        }\n      }\n\n      if (typeof trigger.elements === 'string') {\n        trigger.elements = document.querySelectorAll(trigger.elements)\n      } else if (trigger.elements instanceof HTMLElement) {\n        trigger.elements = [trigger.elements]\n      }\n\n      if (!trigger.events) {\n        trigger.events = ['click']\n      } else if (typeof trigger.events === 'string') {\n        trigger.events = [trigger.events]\n      }\n\n      if (!trigger.action || !actions.includes(trigger.action)) {\n        trigger.action = 'toggle'\n      }\n\n      for (let e = 0; e < trigger.elements.length; e++) {\n        const triggerElement = trigger.elements[e]\n        let triggerElementTargets = triggerElement.getAttribute('data-minitaur-' + trigger.action)\n        let triggerElementEvents = triggerElement.getAttribute('data-minitaur-event')\n\n        if (triggerElementTargets) {\n          triggerElementTargets = triggerElementTargets.split(',')\n\n          if (!triggerElementTargets.includes('#' + modal.id)) {\n            triggerElementTargets.push('#' + modal.id)\n            triggerElement.setAttribute('data-minitaur-' + trigger.action, triggerElementTargets.join(','))\n          }\n        } else {\n          triggerElement.setAttribute('data-minitaur-' + trigger.action, '#' + modal.id)\n        }\n\n        if (triggerElementEvents) {\n          triggerElementEvents = triggerElementEvents.split(',')\n\n          for (let te = 0; te < trigger.events.length; te++) {\n            const triggerEvent = trigger.events[te]\n\n            if (!triggerElementEvents.includes(triggerEvent)) {\n              triggerElementEvents.push(triggerEvent)\n            }\n          }\n\n          triggerElement.setAttribute('data-minitaur-event', triggerElementEvents.join(','))\n        } else {\n          triggerElement.setAttribute('data-minitaur-event', trigger.events.join(','))\n        }\n      }\n    }\n\n    for (let a = 0; a < actions.length; a++) {\n      const action = actions[a]\n      const triggerElements = document.querySelectorAll('[data-minitaur-' + action + '=\"#' + modal.id + '\"], #' + modal.id + ' [data-minitaur-' + action + '=\"\"]')\n\n      for (let ae = 0; ae < triggerElements.length; ae++) {\n        (function (triggerElement) {\n          let triggerEvents = triggerElement.getAttribute('data-minitaur-event')\n          let triggerTargets = triggerElement.getAttribute('data-minitaur-' + action)\n\n          if (triggerTargets === '') {\n            triggerElement.setAttribute('data-minitaur-' + action, '#' + modal.id)\n          }\n\n          if (triggerEvents) {\n            triggerEvents = triggerEvents.split(',')\n          } else {\n            triggerEvents = ['click']\n            triggerElement.setAttribute('data-minitaur-event', 'click')\n          }\n\n          for (let aee = 0; aee < triggerEvents.length; aee++) {\n            let triggerEvent = triggerEvents[aee]\n            triggerElement.addEventListener(triggerEvent, minitaur.triggerEvent)\n          }\n\n          triggerElement.minitaurIgnore = true\n          triggerElement.setAttribute('data-minitaur-trigger', '')\n        })(triggerElements[ae])\n      }\n    }\n  }\n}\n\nminitaur.kill = (modals, putBack) => {\n  modals = minitaur.getModals(modals, true)\n\n  const actions = ['close', 'open', 'toggle']\n  const triggerElements = document.querySelectorAll('[data-minitaur-trigger]')\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      const opts = minitaur.get(modal, true, false)\n\n      if (opts.isOpen) opts.close()\n\n      document.body.removeChild(modal)\n\n      if (putBack !== false) {\n        if (opts.originalElement && opts.originalElementParent && opts.originalElementIndex) {\n          if (opts.originalElementIndex) {\n            if (opts.originalElementIndex > opts.originalElementParent.childNodes.length - 1) {\n              opts.originalElementParent.append(opts.originalElement)\n            } else {\n              opts.originalElementParent.insertBefore(\n                opts.originalElement,\n                opts.originalElementParent.childNodes[opts.originalElementIndex]\n              )\n            }\n          } else {\n            opts.originalElementParent.prepend(opts.originalElement)\n          }\n        }\n      }\n\n      for (let t = 0; t < triggerElements.length; t++) {\n        const triggerElement = triggerElements[t]\n        let nullActions = 0\n\n        for (let a = 0; a < actions.length; a++) {\n          const action = actions[a]\n          let triggerElementTargets = triggerElement.getAttribute('data-minitaur-' + action)\n\n          if (triggerElementTargets) {\n            triggerElementTargets = triggerElementTargets.split(',')\n\n            let triggerElementTargetIndex = triggerElementTargets.indexOf('#' + modal.id)\n\n            if (triggerElementTargetIndex !== -1) {\n              triggerElementTargets.splice(triggerElementTargetIndex, 1)\n\n              if (!triggerElementTargets.length) {\n                nullActions++\n              }\n            }\n          } else {\n            nullActions++\n          }\n        }\n\n        if (nullActions === actions.length) {\n          let triggerEvents = triggerElement.getAttribute('data-minitaur-event')\n          triggerEvents = triggerEvents ? triggerEvents.split(',') : []\n\n          triggerElement.removeAttribute('data-minitaur-event')\n          triggerElement.removeAttribute('data-minitaur-trigger')\n\n          for (let e = 0; e < triggerEvents.length; e++) {\n            triggerElement.removeEventListener(triggerEvents[e], minitaur.triggerEvent)\n          }\n\n          delete triggerElement.minitaurIgnore\n        }\n      }\n\n      minitaur.modalCount--\n    })(modals[i])\n  }\n\n  if (!minitaur.modalCount) {\n    document.removeEventListener('click', minitaur.documentClick)\n    window.removeEventListener('resize', minitaur.documentResize)\n    window.removeEventListener('scroll', minitaur.documentScroll)\n\n    minitaur.initiated = false\n  }\n}\n\nminitaur.mergeObjects = (...objects) => {\n  const isObject = function (obj) { return obj && typeof obj === 'object' && !(obj instanceof HTMLElement) }\n\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const pVal = prev[key]\n      const oVal = obj[key]\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = [...pVal, ...oVal].filter((element, index, array) => {\n          return array.indexOf(element) === index\n        })\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = minitaur.mergeObjects(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n\nminitaur.open = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (options) modal.minitaur.set(options)\n\n      let opts = minitaur.get(modal, true, false)\n\n      if (window.minitaurDebug) console.log('minitaur.open (#' + modal.id + '):', opts)\n\n      minitaur.clearTimers(modal)\n\n      if (opts.beforeOpen && opts.beforeOpen(modal) === false) {\n        return false\n      }\n\n      if (opts.content) {\n        if (typeof opts.content === 'function') {\n          opts.content = opts.content(modal)\n        }\n\n        if (modal.innerHTML !== opts.content) {\n          modal.innerHTML = opts.content\n        }\n      }\n\n      if (opts.parameters) {\n        for (let parameter in opts.parameters) {\n          modal.innerHTML = modal.innerHTML.replace(\n            new RegExp('{' + parameter + '}', 'g'),\n            opts.parameters[parameter]\n          )\n        }\n      }\n\n      modal.classList.remove(opts.closeClass)\n      modal.classList.remove(opts.closingClass)\n      modal.classList.add(opts.openingClass)\n      minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.openingStyle || {}))\n\n      let backdrop = null\n\n      if (opts.takeover && !document.querySelector('#' + modal.id + '-backdrop')) {\n        window.removeEventListener('scroll', minitaur.documentScroll)\n\n        minitaur.close('[data-minitaur][data-minitaur-taking-over]')\n\n        backdrop = document.createElement('div')\n\n        backdrop.id = modal.id + '-backdrop'\n\n        modal.setAttribute('data-minitaur-taking-over', '')\n        backdrop.setAttribute('data-minitaur-backdrop', '#' + modal.id)\n        backdrop.classList.add(opts.backdropClass)\n        backdrop.classList.add(opts.openingClass)\n\n        minitaur.setStyle(backdrop, minitaur.mergeObjects({\n          position: 'absolute',\n          left: '0px',\n          top: '0px',\n          right: '0px',\n          bottom: '0px',\n          zIndex: 99998\n        }, opts.backdropOpeningStyle || {}))\n\n        minitaur.setStyle(document.body, {\n          position: 'fixed',\n          left: '-' + window.scrollX + 'px',\n          top: '-' + window.scrollY + 'px',\n          height: document.body.clientHeight + 'px',\n          width: document.body.clientWidth + 'px'\n        })\n\n        document.body.insertBefore(backdrop, modal)\n      } else {\n        minitaur.setStyle(document.body, { position: 'relative' })\n      }\n\n      modal.minitaur.openDurationTimer = setTimeout(function () {\n        modal.minitaur.isOpen = true\n\n        modal.classList.remove(opts.openingClass)\n        modal.classList.add(opts.openClass)\n\n        if (opts.takeover && backdrop) {\n          backdrop.classList.remove(opts.openingClass)\n          backdrop.classList.add(opts.openClass)\n          minitaur.setStyle(backdrop, opts.backdropStyle || {})\n        }\n\n        minitaur.setDimensions(modal, opts)\n        minitaur.initiateTriggers(modal)\n\n        modal.dispatchEvent(new Event('open', { bubbles: true }))\n\n        if (opts.afterOpen) {\n          opts.afterOpen(modal)\n        }\n      }, opts.openDuration || 0)\n    })(modals[i])\n  }\n}\n\nminitaur.parseAttributes = (data) => {\n  let opts = {}\n  const keyPrefix = 'minitaur'\n  const arrayParameters = ['class']\n  const objectParameters = ['anchor', 'backdropStyle', 'breakpoints', 'closeStyle', 'openStyle', 'parameters', 'position', 'respectAnchorSpacing', 'style']\n  const deepObjectParameters = ['breakpoints']\n  const validParameters = Object.keys(minitaur.defaultOptions).concat(['triggerElement'])\n\n  for (let key in data) {\n    if (key !== keyPrefix && key.substring(0, keyPrefix.length).toLowerCase() === keyPrefix.toLowerCase()) {\n      const property = key.charAt(keyPrefix.length).toLowerCase() + key.substring(keyPrefix.length + 1).replace('-', '')\n      let propSet = false\n      let value = data[key]\n\n      if (value.toLowerCase() === 'true' || !value.length) {\n        value = true\n      } else if (value.toLowerCase() === 'false') {\n        value = false\n      }\n\n      if (arrayParameters.includes(property)) {\n        value = value.split(',')\n      }\n\n      for (let o = 0; o < objectParameters.length; o++) {\n        const objKey = objectParameters[o]\n        const objProp = property.substring(0, objKey.length)\n\n        if (objProp.length !== property.length && objProp.toLowerCase() === objKey.toLowerCase()) {\n          const objPropKey = property.substring(objKey.length).toLowerCase()\n\n          if (!opts[objKey]) {\n            opts[objKey] = {}\n          }\n\n          if (deepObjectParameters.includes(objProp)) {\n            let breakpoint = objPropKey.match(/^\\d+/)\n\n            if (breakpoint) {\n              opts[objKey][breakpoint[0]] = minitaur.parseAttributes({ [keyPrefix + objPropKey.substring(breakpoint[0].length)]: value })\n            } else {\n              opts[objKey] = minitaur.parseAttributes({ [keyPrefix + objPropKey]: value })\n            }\n          } else {\n            opts[objKey][objPropKey] = value\n          }\n\n          propSet = true\n          break\n        }\n      }\n\n      if (!propSet && validParameters.includes(property)) {\n        opts[property] = value\n      }\n    }\n  }\n\n  return opts\n}\n\nminitaur.parseOptions = (opts) => {\n  if (opts.takeover) opts.anchor = 'viewport'\n\n  if (!opts.anchor || typeof opts.anchor === 'string') {\n    opts.anchor = {\n      x: opts.anchor,\n      y: opts.anchor\n    }\n  }\n\n  if (!opts.position || typeof opts.position === 'string') {\n    opts.position = opts.position ? opts.position.split(' ') : ['middle']\n    opts.position = {\n      x: opts.position[1] || 'middle',\n      y: opts.position[0]\n    }\n  }\n\n  if (!opts.position.x) opts.position.x = 'middle'\n  if (!opts.position.y) opts.position.y = 'middle'\n\n  if (!opts.respectAnchorSpacing || typeof opts.respectAnchorSpacing === 'boolean') {\n    opts.respectAnchorSpacing = {\n      x: opts.respectAnchorSpacing,\n      y: opts.respectAnchorSpacing\n    }\n  }\n\n  if (!opts.respectAnchorSpacing.x) opts.respectAnchorSpacing.x = false\n  if (!opts.respectAnchorSpacing.y) opts.respectAnchorSpacing.y = false\n\n  return opts\n}\n\nminitaur.set = (modals, options, value) => {\n  modals = minitaur.getModals(modals, true)\n\n  if (typeof options === 'string') {\n    options = { [options]: value }\n  }\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (window.minitaurDebug) console.log('minitaur.set (#' + modal.id + '):', options)\n      modal.minitaur = minitaur.parseOptions(minitaur.mergeObjects(modal.minitaur, options || {}))\n    })(modals[i])\n  }\n}\n\nminitaur.setDimensions = (modal, options, final) => {\n  let opts = minitaur.get(modal, true, false)\n\n  opts = minitaur.mergeObjects(opts, options || {})\n\n  if (!opts.anchor.x) opts.anchor.x = opts.triggerElement || document.body\n  if (!opts.anchor.y) opts.anchor.y = opts.triggerElement || document.body\n\n  let anchorXElement = null\n  let anchorYElement = null\n\n  if (typeof opts.anchor.x === 'string') {\n    if (opts.anchor.x === 'viewport') {\n      anchorXElement = document.body\n    } else {\n      anchorXElement = document.querySelector(opts.anchor.x)\n    }\n  } else {\n    anchorXElement = opts.anchor.x\n  }\n\n  if (typeof opts.anchor.y === 'string') {\n    if (opts.anchor.y === 'viewport') {\n      anchorYElement = document.body\n    } else {\n      anchorYElement = document.querySelector(opts.anchor.y)\n    }\n  } else {\n    anchorYElement = opts.anchor.y\n  }\n\n  if (!(anchorXElement instanceof HTMLElement)) {\n    console.warn('(minitaur: #' + modal.id + ') Unable to find anchor.x:', anchorXElement)\n    anchorXElement = document.body\n  }\n\n  if (!(anchorYElement instanceof HTMLElement)) {\n    console.warn('(minitaur: #' + modal.id + ') Unable to find anchor.y:', anchorYElement)\n    anchorYElement = document.body\n  }\n\n  const modalClone = modal.cloneNode(true)\n\n  minitaur.setStyle(modalClone, minitaur.mergeObjects(opts.style || {}, opts.openStyle || {}, {\n    left: '0px',\n    opacity: '0',\n    position: 'absolute',\n    top: '0px',\n    transition: 'none'\n  }))\n\n  document.body.appendChild(modalClone)\n\n  const modalStyle = getComputedStyle(modalClone)\n  const anchorXRect = anchorXElement.getBoundingClientRect()\n  let anchorXLeft = anchorXRect.x + window.scrollX\n  let anchorXTop = anchorXRect.y + window.scrollY\n  let anchorXWidth = anchorXRect.width\n  let anchorXHeight = anchorXRect.height\n  let anchorYRect = anchorYElement.getBoundingClientRect()\n  let anchorYLeft = anchorYRect.x + window.scrollX\n  let anchorYTop = anchorYRect.y + window.scrollY\n  let anchorYWidth = anchorYRect.width\n  let anchorYHeight = anchorYRect.height\n  const modalMarginLeft = parseFloat(modalStyle.getPropertyValue('margin-left'))\n  const modalMarginTop = parseFloat(modalStyle.getPropertyValue('margin-top'))\n  const modalMarginRight = parseFloat(modalStyle.getPropertyValue('margin-right'))\n  const modalMarginBottom = parseFloat(modalStyle.getPropertyValue('margin-bottom'))\n  const modalWidth = modalClone.offsetWidth + modalMarginLeft + modalMarginRight\n  const modalHeight = modalClone.offsetHeight + modalMarginTop + modalMarginBottom\n  let left = 0\n  let top = 0\n  let width = parseFloat(modalClone.style.width || modalStyle.getPropertyValue('width'))\n  let height = parseFloat(modalClone.style.height || modalStyle.getPropertyValue('height'))\n  let boundaryX = document.body.clientWidth\n  let boundaryY = document.body.clientHeight\n  let adjustTopPositionFirst = false\n\n  document.body.removeChild(modalClone)\n\n  if (opts.anchor.x === 'viewport') {\n    anchorXLeft = window.scrollX\n    anchorXTop = window.scrollY\n    anchorXWidth = window.innerWidth\n    anchorXHeight = window.innerHeight\n    boundaryX = anchorXWidth + window.scrollX\n  }\n\n  if (opts.anchor.y === 'viewport') {\n    anchorYLeft = window.scrollX\n    anchorYTop = window.scrollY\n    anchorYWidth = window.innerWidth\n    anchorYHeight = window.innerHeight\n    boundaryY = anchorYHeight + window.scrollY\n  }\n\n  if (opts.takeover) {\n    anchorXLeft = 0 - parseInt(document.body.style.left || '0')\n    anchorXTop = 0 - parseInt(document.body.style.top || '0')\n    anchorYLeft = 0 - parseInt(document.body.style.left || '0')\n    anchorYTop = 0 - parseInt(document.body.style.top || '0')\n    boundaryX = anchorXLeft + window.innerWidth\n    boundaryY = anchorYTop + window.innerHeight\n  }\n\n  if (anchorXElement === document.body) {\n    switch (opts.position.x) {\n      case 'left':\n        opts.position.x = 'inner-left'\n        break\n      case 'right':\n        opts.position.x = 'inner-right'\n        break\n    }\n  }\n\n  if (anchorYElement === document.body) {\n    switch (opts.position.y) {\n      case 'top':\n        opts.position.y = 'inner-top'\n        break\n      case 'bottom':\n        opts.position.y = 'inner-bottom'\n        break\n    }\n  }\n\n  if (opts.respectAnchorSpacing.x) {\n    const anchorXStyle = getComputedStyle(anchorXElement)\n\n    switch (opts.position.x) {\n      case 'inner-left':\n        anchorXLeft += parseFloat(anchorXStyle.getPropertyValue('padding-left'))\n        break\n      case 'left':\n        anchorXLeft -= parseFloat(anchorXStyle.getPropertyValue('margin-left'))\n        break\n      case 'inner-right':\n        anchorXWidth -= parseFloat(anchorXStyle.getPropertyValue('padding-right'))\n        break\n      case 'right':\n        anchorXWidth += parseFloat(anchorXStyle.getPropertyValue('margin-right'))\n        break\n    }\n  }\n\n  if (opts.respectAnchorSpacing.y) {\n    const anchorYStyle = getComputedStyle(anchorYElement)\n\n    switch (opts.position.y) {\n      case 'inner-top':\n        anchorYTop += parseFloat(anchorYStyle.getPropertyValue('padding-top'))\n        break\n      case 'top':\n        anchorYTop -= parseFloat(anchorYStyle.getPropertyValue('margin-top'))\n        break\n      case 'inner-bottom':\n        anchorYHeight -= parseFloat(anchorYStyle.getPropertyValue('padding-bottom'))\n        break\n      case 'bottom':\n        anchorXHeight += parseFloat(anchorYStyle.getPropertyValue('margin-bottom'))\n        break\n    }\n  }\n\n  if (window.minitaurDebug) {\n    console.log('minitaur.setDimensions (#' + modal.id + '):', {\n      anxhorX: {\n        element: anchorXElement,\n        left: anchorXLeft,\n        top: anchorXTop,\n        width: anchorXWidth,\n        height: anchorXHeight,\n        rect: anchorXRect,\n        boundary: boundaryX\n      },\n      anxhorY: {\n        element: anchorYElement,\n        left: anchorYLeft,\n        top: anchorYTop,\n        width: anchorYWidth,\n        height: anchorYHeight,\n        rect: anchorYRect,\n        boundary: boundaryY\n      },\n      modal: {\n        height: modalHeight,\n        width: modalWidth\n      },\n      scroll: {\n        x: window.scrollX,\n        y: window.scrollY\n      }\n    })\n  }\n\n  switch (opts.position.x) {\n    case 'inner-left':\n      left = anchorXLeft\n      break\n    case 'left':\n      left = anchorXLeft - modalWidth - 1\n      break\n    case 'middle':\n      left = anchorXLeft + (anchorXWidth / 2) - (modalWidth / 2)\n      break\n    case 'inner-right':\n      left = anchorXLeft + anchorXWidth - modalWidth\n      break\n    case 'right':\n      left = anchorXLeft + anchorXWidth + 1\n      break\n    default:\n      if (typeof opts.position.x === 'string') {\n        if (opts.position.x[opts.position.x.length - 1] === '%') {\n          left = anchorXLeft + ((opts.position.x.substr(0, opts.position.x.length - 1) / 100) * anchorXWidth)\n        } else {\n          left = anchorXLeft + parseInt(opts.position.x)\n        }\n      } else if (Number.isFinite(opts.position.x)) {\n        left = anchorXLeft + opts.position.x\n      } else {\n        console.warn('minitaur (#' + modal.id + ') Invalid position.x value:', opts.position.x)\n        return false\n      }\n  }\n\n  switch (opts.position.y) {\n    case 'inner-top':\n      top = anchorYTop\n      break\n    case 'top':\n      top = anchorYTop - modalHeight - 1\n      break\n    case 'middle':\n      top = anchorYTop + (anchorYHeight / 2) - (modalHeight / 2)\n      break\n    case 'inner-bottom':\n      top = anchorYTop + anchorYHeight - modalHeight\n      break\n    case 'bottom':\n      top = anchorYTop + anchorYHeight + 1\n      break\n    default:\n      if (typeof opts.position.y === 'string') {\n        if (opts.position.y[opts.position.y.length - 1] === '%') {\n          top = anchorYTop + ((opts.position.y.substr(0, opts.position.y.length - 1) / 100) * anchorYHeight)\n        } else {\n          top = anchorYTop + parseInt(opts.position.y)\n        }\n      } else if (Number.isFinite(opts.position.y)) {\n        top = anchorYTop + opts.position.y\n      } else {\n        console.warn('minitaur (#' + modal.id + ') Invalid position.y value:', opts.position.y)\n        return false\n      }\n  }\n\n  if (opts.stayInBounds) {\n    if ((left + modalWidth) >= boundaryX) {\n      left = boundaryX - modalWidth\n    }\n\n    if (left < 0) {\n      left = 0\n    }\n\n    if ((top + modalHeight) >= boundaryY) {\n      top = boundaryY - modalHeight\n      adjustTopPositionFirst = true\n    }\n\n    if (top < 0) {\n      top = 0\n      adjustTopPositionFirst = true\n    }\n\n    if (\n      opts.position.x === 'left' ||\n      opts.position.x === 'right' ||\n      opts.position.y === 'top' ||\n      opts.position.y === 'bottom'\n    ) {\n      let anchorXOverlap = false\n      let anchorYOverlap = false\n\n      if (anchorXElement !== document.body) {\n        let anchorXLeftOverlap = (\n          (left >= anchorXLeft && left < (anchorXLeft + anchorXWidth)) ||\n          (left < anchorXLeft && (left + modalWidth) >= anchorXLeft)\n        )\n\n        let anchorXTopOverlap = (\n          (top >= anchorXTop && top < (anchorXTop + anchorXHeight)) ||\n          (top < anchorXTop && (top + modalHeight) >= anchorXTop)\n        )\n\n        anchorXOverlap = anchorXLeftOverlap && anchorXTopOverlap\n      }\n\n      if (anchorYElement !== document.body) {\n        let anchorYLeftOverlap = (\n          (left >= anchorYLeft && left < (anchorYLeft + anchorYWidth)) ||\n          (left < anchorYLeft && (left + modalWidth) >= anchorYLeft)\n        )\n\n        let anchorYTopOverlap = (\n          (top >= anchorYTop && top < (anchorYTop + anchorYHeight)) ||\n          (top < anchorYTop && (top + modalHeight) >= anchorYTop)\n        )\n\n        anchorYOverlap = anchorYLeftOverlap && anchorYTopOverlap\n      }\n\n      if (anchorXOverlap || anchorYOverlap) {\n        if (!adjustTopPositionFirst) {\n          if (opts.position.x === 'left') {\n            if (!final) {\n              opts.position.x = 'right'\n              return minitaur.setDimensions(modal, opts, true)\n            }\n          } else {\n            opts.position.x = 'left'\n            return minitaur.setDimensions(modal, opts, true)\n          }\n        } else {\n          if (opts.position.y === 'top') {\n            if (!final) {\n              opts.position.y = 'bottom'\n              return minitaur.setDimensions(modal, opts, true)\n            }\n          } else {\n            opts.position.y = 'top'\n            return minitaur.setDimensions(modal, opts, true)\n          }\n        }\n      }\n    }\n  }\n\n  minitaur.setStyle(modal, minitaur.mergeObjects({ zIndex: opts.takeover ? 99999 : null }, opts.style || {}, opts.openStyle || {}, {\n    position: 'absolute',\n    left: left + 'px',\n    top: top + 'px',\n    width: width + 'px',\n    height: height + 'px'\n  }))\n\n  return true\n}\n\nminitaur.setStyle = (element, styles) => {\n  if (window.minitaurDebug) console.log('minitaur.setStyle (' + (element.id ? '#' + element.id : element.tagName) + '):', styles)\n\n  for (let property in styles) {\n    element.style[property] = styles[property]\n  }\n}\n\nminitaur.toggle = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (window.minitaurDebug) console.log('minitaur.toggle (#' + modal.id + '):', options)\n\n      if (modal.minitaur.isOpen) {\n        modal.minitaur.close(options)\n      } else {\n        modal.minitaur.open(options)\n      }\n    })(modals[i])\n  }\n}\n\nminitaur.triggerEvent = (e) => {\n  const actions = ['close', 'open', 'toggle']\n  let triggerElement = e.currentTarget\n  const opts = minitaur.mergeObjects(minitaur.parseAttributes(triggerElement.dataset), { triggerElement: triggerElement })\n\n  for (let i = 0; i < actions.length; i++) {\n    let action = actions[i]\n    let targetElements = triggerElement.getAttribute('data-minitaur-' + action)\n\n    if (targetElements) {\n      if (window.minitaurDebug) console.log('minitaur.triggerEvent:', targetElements, opts)\n      minitaur[action](targetElements, opts)\n    }\n  }\n}\n\nexport default minitaur\n"],"names":["minitaur","mount","options","elements","modals","constructor","Object","mergeObjects","defaultOptions","document","querySelectorAll","HTMLElement","id","getElementById","createElement","getModals","length","i","modal","beforeInit","modalCount","funcs","close","get","parseBreakpoints","kill","putBack","open","set","value","toggle","opts","parseOptions","parseAttributes","dataset","isOpen","parentNode","body","originalElement","cloneNode","originalElementIndex","Array","prototype","indexOf","call","childNodes","originalElementParent","removeChild","setAttribute","window","minitaurDebug","console","log","class","c","classList","add","setStyle","style","closeStyle","initiateTriggers","appendChild","opened","afterInit","push","initiated","addEventListener","documentClick","documentResize","documentScroll","afterClose","afterOpen","anchor","backdropClass","backdropClosingStyle","backdropOpeningStyle","backdropStyle","backgroundColor","beforeClose","beforeOpen","breakpoints","closeClass","closeDuration","closingClass","closingStyle","closeOnFocusOut","display","visibility","content","openClass","openDuration","openingClass","openingStyle","openStyle","parameters","position","respectAnchorSpacing","stayInBounds","takeover","triggers","clearTimers","resizeTimer","clearTimeout","closeDurationTimer","openDurationTimer","remove","backdrop","removeAttribute","querySelector","scrollX","parseInt","left","scrollY","top","height","width","scrollTo","setTimeout","dispatchEvent","Event","bubbles","e","element","target","closeModals","minitaurIgnore","contains","x","y","verify","breakpointOpts","breakpoint","documentElement","clientWidth","verifiedElements","warn","actions","trigger","action","events","reduce","validTriggers","isArray","t","includes","triggerElement","triggerElementTargets","getAttribute","triggerElementEvents","split","join","te","triggerEvent","a","triggerElements","ae","triggerEvents","triggerTargets","aee","append","insertBefore","prepend","nullActions","triggerElementTargetIndex","splice","removeEventListener","isObject","obj","objects","prev","keys","forEach","key","pVal","oVal","filter","index","array","innerHTML","parameter","replace","RegExp","right","bottom","zIndex","clientHeight","setDimensions","data","keyPrefix","arrayParameters","objectParameters","deepObjectParameters","validParameters","concat","substring","toLowerCase","property","charAt","propSet","o","objKey","objProp","objPropKey","match","final","anchorXElement","anchorYElement","modalClone","opacity","transition","modalStyle","getComputedStyle","anchorXRect","getBoundingClientRect","anchorXLeft","anchorXTop","anchorXWidth","anchorXHeight","anchorYRect","anchorYLeft","anchorYTop","anchorYWidth","anchorYHeight","modalMarginLeft","parseFloat","getPropertyValue","modalMarginTop","modalMarginRight","modalMarginBottom","modalWidth","offsetWidth","modalHeight","offsetHeight","boundaryX","boundaryY","adjustTopPositionFirst","innerWidth","innerHeight","anchorXStyle","anchorYStyle","anxhorX","rect","boundary","anxhorY","scroll","substr","Number","isFinite","anchorXOverlap","anchorYOverlap","anchorXLeftOverlap","anchorXTopOverlap","anchorYLeftOverlap","anchorYTopOverlap","styles","tagName","currentTarget","targetElements"],"mappings":"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"}