{"version":3,"file":"minitaur.js","sources":["../src/minitaur.js"],"sourcesContent":["/*!\n  minitaur v0.1.0 (https://github.com/kodie/minitaur)\n  by Kodie Grantham (https://kodieg.com)\n*/\n\nconst minitaurDebug = (typeof window.minitaurDebug === 'undefined') ? false : window.minitaurDebug\n\nconst minitaur = (mount, options) => {\n  let elements = []\n  let modals = []\n\n  if (mount && mount.constructor === Object) {\n    options = mount\n    mount = null\n  }\n\n  options = minitaur.mergeObjects(minitaur.defaultOptions, options || {})\n\n  if (!mount) mount = options.mount\n\n  if (typeof mount === 'string') {\n    elements = document.querySelectorAll(mount)\n  } else if (mount instanceof HTMLElement) {\n    elements = [mount]\n  } else if (!mount) {\n    elements = [document.createElement('div')]\n  }\n\n  elements = minitaur.getModals(elements)\n\n  if (elements && elements.length) {\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (modal.minitaur) {\n          return true\n        }\n\n        if (options.beforeInit && options.beforeInit(modal) === false) {\n          return false\n        }\n\n        minitaur.modalCount++\n\n        let funcs = {\n          close: function (options) {\n            return minitaur.close(modal, options)\n          },\n          get: function (parseBreakpoints) {\n            return minitaur.get(modal, parseBreakpoints, false)\n          },\n          kill: function (putBack) {\n            return minitaur.kill(modal, putBack)\n          },\n          open: function (options) {\n            return minitaur.open(modal, options)\n          },\n          set: function (options, value) {\n            return minitaur.set(modal, options, value)\n          },\n          toggle: function (options) {\n            return minitaur.toggle(modal, options)\n          }\n        }\n\n        let opts = minitaur.parseOptions(minitaur.mergeObjects(options, minitaur.parseAttributes(modal.dataset), funcs, {\n          isOpen: false\n        }))\n\n        if (modal.parentNode && modal.parentNode !== document.body) {\n          opts.originalElement = modal.cloneNode(true)\n          opts.originalElementIndex = Array.prototype.indexOf.call(modal.parentNode.childNodes, modal)\n          opts.originalElementParent = modal.parentNode\n          modal.parentNode.removeChild(modal)\n        }\n\n        modal.minitaur = opts\n        modal.setAttribute('data-minitaur', '')\n\n        opts = minitaur.get(modal, true, false)\n\n        if (opts.id) {\n          modal.id = opts.id\n        } else if (!modal.id) {\n          modal.id = 'minitaur-' + minitaur.modalCount\n        }\n\n        if (minitaurDebug) console.log('minitaur.init (#' + modal.id + '):', opts)\n\n        if (opts.class) {\n          if (typeof opts.class === 'string') {\n            opts.class = [opts.class]\n          }\n\n          for (let c = 0; c < opts.class.length; c++) {\n            modal.classList.add(opts.class[c])\n          }\n        }\n\n        minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closeStyle || {}))\n        minitaur.initiateTriggers(modal)\n\n        if (!modal.parentNode) {\n          document.body.appendChild(modal)\n        }\n\n        if (opts.opened) {\n          modal.minitaur.open()\n        } else {\n          modal.minitaur.close()\n        }\n\n        if (opts.afterInit) {\n          options.afterInit(modal)\n        }\n\n        modals.push(modal)\n      })(elements[i])\n    }\n  }\n\n  if (!minitaur.initiated) {\n    minitaur.initiated = true\n\n    document.addEventListener('click', minitaur.documentClick)\n    window.addEventListener('resize', minitaur.documentResize)\n    window.addEventListener('scroll', minitaur.documentScroll)\n  }\n\n  if (modals.length) {\n    if (modals.length === 1) {\n      return modals[0]\n    }\n\n    return modals\n  }\n\n  return false\n}\n\nminitaur.initiated = false\nminitaur.modalCount = 0\n\nminitaur.defaultOptions = {\n  afterClose: null,\n  afterInit: null,\n  afterOpen: null,\n  anchor: null,\n  backdropClass: 'minitaur-backdrop',\n  backdropClosingStyle: null,\n  backdropOpeningStyle: null,\n  backdropStyle: {\n    backgroundColor: 'rgba(0, 0, 0, 0.5)'\n  },\n  beforeClose: null,\n  beforeInit: null,\n  beforeOpen: null,\n  breakpoints: null,\n  class: 'minitaur',\n  closeClass: 'closed',\n  closeDuration: 0,\n  closingClass: 'closing',\n  closingStyle: null,\n  closeOnFocusOut: true,\n  closeStyle: {\n    display: 'none',\n    visibility: 'hidden'\n  },\n  content: null,\n  id: null,\n  mount: '.minitaur, [data-minitaur]',\n  opened: false,\n  openClass: 'opened',\n  openDuration: 0,\n  openingClass: 'opening',\n  openingStyle: {\n    display: 'block',\n    visibility: 'visible'\n  },\n  openStyle: null,\n  parameters: null,\n  position: 'middle',\n  respectAnchorSpacing: false,\n  stayInBounds: true,\n  style: null,\n  takeover: false,\n  triggers: []\n}\n\nminitaur.clearTimers = function (modal) {\n  if (minitaur.resizeTimer) {\n    clearTimeout(minitaur.resizeTimer)\n    minitaur.resizeTimer = null\n  }\n\n  if (modal) {\n    if (modal.minitaur.closeDurationTimer) {\n      clearTimeout(modal.minitaur.closeDurationTimer)\n      modal.minitaur.closeDurationTimer = null\n    }\n\n    if (modal.minitaur.openDurationTimer) {\n      clearTimeout(modal.minitaur.openDurationTimer)\n      modal.minitaur.openDurationTimer = null\n    }\n  }\n}\n\nminitaur.close = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (options) modal.minitaur.set(options)\n\n      const opts = minitaur.get(modal, true, false)\n\n      if (minitaurDebug) console.log('minitaur.close (#' + modal.id + '):', opts)\n\n      minitaur.clearTimers(modal)\n\n      if (opts.beforeClose && opts.beforeClose(modal) === false) {\n        return false\n      }\n\n      modal.classList.remove(opts.openClass)\n      modal.classList.remove(opts.openingClass)\n      modal.classList.add(opts.closingClass)\n      minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closingStyle || {}))\n\n      let backdrop = null\n\n      if (opts.takeover) {\n        modal.removeAttribute('data-minitaur-taking-over')\n\n        backdrop = document.querySelector('[data-minitaur-backdrop=\"#' + modal.id + '\"]')\n\n        if (backdrop) {\n          backdrop.classList.remove(opts.openClass)\n          backdrop.classList.remove(opts.openingClass)\n          backdrop.classList.add(opts.closingClass)\n\n          const scrollX = parseInt(document.body.style.left || '0') * -1\n          const scrollY = parseInt(document.body.style.top || '0') * -1\n\n          minitaur.setStyle(backdrop, opts.backdropClosingStyle || {})\n\n          minitaur.setStyle(document.body, {\n            position: 'relative',\n            left: null,\n            top: null,\n            height: null,\n            width: null\n          })\n\n          window.scrollTo(scrollX, scrollY)\n        }\n      }\n\n      modal.minitaur.closeDurationTimer = setTimeout(function () {\n        modal.minitaur.isOpen = false\n\n        modal.classList.remove(opts.closingClass)\n        modal.classList.add(opts.closeClass)\n\n        if (opts.takeover && backdrop) {\n          document.body.removeChild(backdrop)\n          window.addEventListener('scroll', minitaur.documentScroll)\n        }\n\n        minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.closeStyle || {}))\n\n        modal.dispatchEvent(new Event('close', { bubbles: true }))\n\n        if (opts.afterClose) {\n          opts.afterClose(modal)\n        }\n      }, opts.closeDuration || 0)\n    })(modals[i])\n  }\n}\n\nminitaur.documentClick = (e) => {\n  let element = e.target\n  let closeModals = true\n\n  do {\n    if (element === document.body) break\n    if (\n      element.minitaur ||\n      element.minitaurIgnore ||\n      element.classList.contains('minitaur-ignore')\n    ) closeModals = false\n  } while ((element = element.parentNode))\n\n  if (closeModals) {\n    const modals = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < modals.length; i++) {\n      let modal = modals[i]\n\n      if (modal.minitaur.closeOnFocusOut && modal.minitaur.isOpen === true) {\n        modal.minitaur.close()\n      }\n    }\n  }\n}\n\nminitaur.documentResize = (e) => {\n  minitaur.clearTimers()\n\n  minitaur.resizeTimer = setTimeout(function () {\n    const elements = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (modal.minitaur.isOpen) {\n          modal.minitaur.open()\n        }\n      })(elements[i])\n    }\n  }, 60)\n}\n\nminitaur.documentScroll = (e) => {\n  minitaur.clearTimers()\n\n  minitaur.resizeTimer = setTimeout(function () {\n    const elements = minitaur.getModals('[data-minitaur]', true)\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        const opts = modal.minitaur\n\n        if (opts.isOpen && !opts.takeover && (opts.anchor.x === 'viewport' || opts.anchor.y === 'viewport')) {\n          modal.minitaur.open()\n        }\n      })(elements[i])\n    }\n  }, 60)\n}\n\nminitaur.get = (elements, parseBreakpoints, verify) => {\n  elements = minitaur.getModals(elements, verify)\n\n  let modals = []\n\n  for (let i = 0; i < elements.length; i++) {\n    (function (modal) {\n      let opts = minitaur.mergeObjects(modal.minitaur, { element: modal })\n\n      if (parseBreakpoints && opts.breakpoints) {\n        let breakpointOpts = null\n\n        for (let breakpoint in opts.breakpoints) {\n          if (document.documentElement.clientWidth >= parseInt(breakpoint)) {\n            breakpointOpts = opts.breakpoints[breakpoint]\n          }\n        }\n\n        if (breakpointOpts) {\n          opts = minitaur.mergeObjects(opts, breakpointOpts)\n        }\n\n        delete opts.breakpoints\n      }\n\n      modals.push(opts)\n    })(elements[i])\n  }\n\n  if (modals.length) {\n    if (modals.length === 1) {\n      return modals[0]\n    }\n\n    return modals\n  }\n\n  return false\n}\n\nminitaur.getModals = (elements, verify) => {\n  if (typeof elements === 'string') {\n    elements = document.querySelectorAll(elements)\n  } else if (elements instanceof HTMLElement) {\n    elements = [elements]\n  }\n\n  if (verify) {\n    let verifiedElements = []\n\n    for (let i = 0; i < elements.length; i++) {\n      (function (modal) {\n        if (!modal.minitaur) {\n          console.warn('Element doesn\\'t appear to be a minitaur instance:', modal)\n          return\n        }\n\n        verifiedElements.push(modal)\n      })(elements[i])\n    }\n\n    return verifiedElements\n  }\n\n  return elements\n}\n\nminitaur.initiateTriggers = (modals) => {\n  modals = minitaur.getModals(modals, true)\n\n  let actions = ['close', 'open', 'toggle']\n\n  for (let i = 0; i < modals.length; i++) {\n    const modal = modals[i]\n    let opts = minitaur.get(modal, true, false)\n    let triggers = opts.triggers\n\n    if (typeof triggers === 'string') {\n      triggers = [{\n        action: 'toggle',\n        elements: triggers,\n        events: ['click']\n      }]\n    } else if (!triggers) {\n      triggers = []\n    }\n\n    triggers = triggers.reduce((validTriggers, trigger) => {\n      if (Array.isArray(trigger)) {\n        trigger.elements = trigger\n      } else if (!trigger.elements) {\n        console.warn('(minitaur: #' + modal.id + ') A trigger is missing it\\'s elements option.', trigger)\n        return validTriggers\n      }\n\n      validTriggers.push(trigger)\n      return validTriggers\n    }, [])\n\n    for (let t = 0; t < triggers.length; t++) {\n      let trigger = triggers[t]\n\n      if (typeof trigger === 'string') {\n        trigger = {\n          action: 'toggle',\n          elements: trigger,\n          events: ['click']\n        }\n      }\n\n      if (typeof trigger.elements === 'string') {\n        trigger.elements = document.querySelectorAll(trigger.elements)\n      } else if (trigger.elements instanceof HTMLElement) {\n        trigger.elements = [trigger.elements]\n      }\n\n      if (!trigger.events) {\n        trigger.events = ['click']\n      } else if (typeof trigger.events === 'string') {\n        trigger.events = [trigger.events]\n      }\n\n      if (!trigger.action || !actions.includes(trigger.action)) {\n        trigger.action = 'toggle'\n      }\n\n      for (let e = 0; e < trigger.elements.length; e++) {\n        const triggerElement = trigger.elements[e]\n        let triggerElementTargets = triggerElement.getAttribute('data-minitaur-' + trigger.action)\n        let triggerElementEvents = triggerElement.getAttribute('data-minitaur-event')\n\n        if (triggerElementTargets) {\n          triggerElementTargets = triggerElementTargets.split(',')\n\n          if (!triggerElementTargets.includes('#' + modal.id)) {\n            triggerElementTargets.push('#' + modal.id)\n            triggerElement.setAttribute('data-minitaur-' + trigger.action, triggerElementTargets.join(','))\n          }\n        } else {\n          triggerElement.setAttribute('data-minitaur-' + trigger.action, '#' + modal.id)\n        }\n\n        if (triggerElementEvents) {\n          triggerElementEvents = triggerElementEvents.split(',')\n\n          for (let te = 0; te < trigger.events.length; te++) {\n            const triggerEvent = trigger.events[te]\n\n            if (!triggerElementEvents.includes(triggerEvent)) {\n              triggerElementEvents.push(triggerEvent)\n            }\n          }\n\n          triggerElement.setAttribute('data-minitaur-event', triggerElementEvents.join(','))\n        } else {\n          triggerElement.setAttribute('data-minitaur-event', trigger.events.join(','))\n        }\n      }\n    }\n\n    for (let a = 0; a < actions.length; a++) {\n      const action = actions[a]\n      const triggerElements = document.querySelectorAll('[data-minitaur-' + action + '=\"#' + modal.id + '\"], #' + modal.id + ' [data-minitaur-' + action + '=\"\"]')\n\n      for (let ae = 0; ae < triggerElements.length; ae++) {\n        (function (triggerElement) {\n          let triggerEvents = triggerElement.getAttribute('data-minitaur-event')\n          let triggerTargets = triggerElement.getAttribute('data-minitaur-' + action)\n\n          if (triggerTargets === '') {\n            triggerElement.setAttribute('data-minitaur-' + action, '#' + modal.id)\n          }\n\n          if (triggerEvents) {\n            triggerEvents = triggerEvents.split(',')\n          } else {\n            triggerEvents = ['click']\n            triggerElement.setAttribute('data-minitaur-event', 'click')\n          }\n\n          for (let aee = 0; aee < triggerEvents.length; aee++) {\n            let triggerEvent = triggerEvents[aee]\n            triggerElement.addEventListener(triggerEvent, minitaur.triggerEvent)\n          }\n\n          triggerElement.minitaurIgnore = true\n          triggerElement.setAttribute('data-minitaur-trigger', '')\n        })(triggerElements[ae])\n      }\n    }\n  }\n}\n\nminitaur.kill = (modals, putBack) => {\n  modals = minitaur.getModals(modals, true)\n\n  const actions = ['close', 'open', 'toggle']\n  const triggerElements = document.querySelectorAll('[data-minitaur-trigger]')\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      const opts = minitaur.get(modal, true, false)\n\n      if (opts.isOpen) opts.close()\n\n      document.body.removeChild(modal)\n\n      if (putBack !== false) {\n        if (opts.originalElement && opts.originalElementParent && opts.originalElementIndex) {\n          opts.originalElementParent.insertBefore(\n            opts.originalElement,\n            opts.originalElementParent.childNodes[opts.originalElementIndex - 1]\n          )\n        }\n      }\n\n      for (let t = 0; t < triggerElements.length; t++) {\n        const triggerElement = triggerElements[t]\n        let nullActions = 0\n\n        for (let a = 0; a < actions.length; a++) {\n          const action = actions[a]\n          let triggerElementTargets = triggerElement.getAttribute('data-minitaur-' + action)\n\n          if (triggerElementTargets) {\n            triggerElementTargets = triggerElementTargets.split(',')\n\n            let triggerElementTargetIndex = triggerElementTargets.indexOf('#' + modal.id)\n\n            if (triggerElementTargetIndex !== -1) {\n              triggerElementTargets.splice(triggerElementTargetIndex, 1)\n\n              if (triggerElementTargets.length) {\n                triggerElement.setAttribute('data-minitaur-' + action, triggerElementTargets.join(','))\n              } else {\n                triggerElement.removeAttribute('data-minitaur-' + action)\n                nullActions++\n              }\n            }\n          } else {\n            nullActions++\n          }\n        }\n\n        if (nullActions === actions.length) {\n          const triggerEvents = triggerElement.getAttribute('data-minitaur-event')\n\n          triggerElement.removeAttribute('data-minitaur-event')\n          triggerElement.removeAttribute('data-minitaur-trigger')\n\n          for (let e = 0; e < triggerEvents.length; e++) {\n            triggerElement.removeEventListener(triggerEvents[e], minitaur.triggerEvent)\n          }\n\n          delete triggerElement.minitaurIgnore\n        }\n      }\n\n      minitaur.modalCount--\n    })(modals[i])\n  }\n\n  if (!minitaur.modalCount) {\n    document.removeEventListener('click', minitaur.documentClick)\n    window.removeEventListener('resize', minitaur.documentResize)\n    window.removeEventListener('scroll', minitaur.documentScroll)\n\n    minitaur.initiated = false\n  }\n}\n\nminitaur.mergeObjects = (...objects) => {\n  const isObject = function (obj) { return obj && typeof obj === 'object' && !(obj instanceof HTMLElement) }\n\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const pVal = prev[key]\n      const oVal = obj[key]\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = [...pVal, ...oVal].filter((element, index, array) => {\n          return array.indexOf(element) === index\n        })\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = minitaur.mergeObjects(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n\nminitaur.open = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (options) modal.minitaur.set(options)\n\n      let opts = minitaur.get(modal, true, false)\n\n      if (minitaurDebug) console.log('minitaur.open (#' + modal.id + '):', opts)\n\n      minitaur.clearTimers(modal)\n\n      if (opts.beforeOpen && opts.beforeOpen(modal) === false) {\n        return false\n      }\n\n      if (opts.content) {\n        if (typeof opts.content === 'function') {\n          opts.content = opts.content(modal)\n        }\n\n        if (modal.innerHTML !== opts.content) {\n          modal.innerHTML = opts.content\n        }\n      }\n\n      if (opts.parameters) {\n        for (let parameter in opts.parameters) {\n          modal.innerHTML = modal.innerHTML.replace(\n            new RegExp('{' + parameter + '}', 'g'),\n            opts.parameters[parameter]\n          )\n        }\n      }\n\n      modal.classList.remove(opts.closeClass)\n      modal.classList.remove(opts.closingClass)\n      modal.classList.add(opts.openingClass)\n      minitaur.setStyle(modal, minitaur.mergeObjects(opts.style || {}, opts.openingStyle || {}))\n\n      let backdrop = null\n\n      if (opts.takeover && !document.querySelector('#' + modal.id + '-backdrop')) {\n        window.removeEventListener('scroll', minitaur.documentScroll)\n\n        minitaur.close('[data-minitaur][data-minitaur-taking-over]')\n\n        backdrop = document.createElement('div')\n\n        backdrop.id = modal.id + '-backdrop'\n\n        modal.setAttribute('data-minitaur-taking-over', '')\n        backdrop.setAttribute('data-minitaur-backdrop', '#' + modal.id)\n        backdrop.classList.add(opts.backdropClass)\n        backdrop.classList.add(opts.openingClass)\n\n        minitaur.setStyle(backdrop, minitaur.mergeObjects({\n          position: 'absolute',\n          left: '0px',\n          top: '0px',\n          right: '0px',\n          bottom: '0px',\n          zIndex: 99998\n        }, opts.backdropOpeningStyle || {}))\n\n        minitaur.setStyle(document.body, {\n          position: 'fixed',\n          left: '-' + window.scrollX + 'px',\n          top: '-' + window.scrollY + 'px',\n          height: document.body.clientHeight + 'px',\n          width: document.body.clientWidth + 'px'\n        })\n\n        document.body.insertBefore(backdrop, modal)\n      } else {\n        minitaur.setStyle(document.body, { position: 'relative' })\n      }\n\n      modal.minitaur.openDurationTimer = setTimeout(function () {\n        modal.minitaur.isOpen = true\n\n        modal.classList.remove(opts.openingClass)\n        modal.classList.add(opts.openClass)\n\n        if (opts.takeover && backdrop) {\n          backdrop.classList.remove(opts.openingClass)\n          backdrop.classList.add(opts.openClass)\n          minitaur.setStyle(backdrop, opts.backdropStyle || {})\n        }\n\n        minitaur.setDimensions(modal, opts)\n        minitaur.initiateTriggers(modal)\n\n        modal.dispatchEvent(new Event('open', { bubbles: true }))\n\n        if (opts.afterOpen) {\n          opts.afterOpen(modal)\n        }\n      }, opts.openDuration || 0)\n    })(modals[i])\n  }\n}\n\nminitaur.parseAttributes = (data) => {\n  let opts = {}\n  const keyPrefix = 'minitaur'\n  const arrayParameters = ['class']\n  const objectParameters = ['anchor', 'backdropStyle', 'breakpoints', 'closeStyle', 'openStyle', 'parameters', 'position', 'respectAnchorSpacing', 'style']\n  const deepObjectParameters = ['breakpoints']\n  const validParameters = Object.keys(minitaur.defaultOptions).concat(['triggerElement'])\n\n  for (let key in data) {\n    if (key !== keyPrefix && key.substring(0, keyPrefix.length).toLowerCase() === keyPrefix.toLowerCase()) {\n      const property = key.charAt(keyPrefix.length).toLowerCase() + key.substring(keyPrefix.length + 1).replace('-', '')\n      let propSet = false\n      let value = data[key]\n\n      if (value.toLowerCase() === 'true' || !value.length) {\n        value = true\n      } else if (value.toLowerCase() === 'false') {\n        value = false\n      }\n\n      if (arrayParameters.includes(property)) {\n        value = value.split(',')\n      }\n\n      for (let o = 0; o < objectParameters.length; o++) {\n        const objKey = objectParameters[o]\n        const objProp = property.substring(0, objKey.length)\n\n        if (objProp.length !== property.length && objProp.toLowerCase() === objKey.toLowerCase()) {\n          const objPropKey = property.substring(objKey.length).toLowerCase()\n\n          if (!opts[objKey]) {\n            opts[objKey] = {}\n          }\n\n          if (deepObjectParameters.includes(objProp)) {\n            let breakpoint = objPropKey.match(/^\\d+/)\n\n            if (breakpoint) {\n              opts[objKey][breakpoint[0]] = minitaur.parseAttributes({ [keyPrefix + objPropKey.substring(breakpoint[0].length)]: value })\n            } else {\n              opts[objKey] = minitaur.parseAttributes({ [keyPrefix + objPropKey]: value })\n            }\n          } else {\n            opts[objKey][objPropKey] = value\n          }\n\n          propSet = true\n          break\n        }\n      }\n\n      if (!propSet && validParameters.includes(property)) {\n        opts[property] = value\n      }\n    }\n  }\n\n  return opts\n}\n\nminitaur.parseOptions = (opts) => {\n  if (opts.takeover) opts.anchor = 'viewport'\n\n  if (!opts.anchor || typeof opts.anchor === 'string') {\n    opts.anchor = {\n      x: opts.anchor,\n      y: opts.anchor\n    }\n  }\n\n  if (!opts.position || typeof opts.position === 'string') {\n    opts.position = opts.position ? opts.position.split(' ') : ['middle']\n    opts.position = {\n      x: opts.position[1] || 'middle',\n      y: opts.position[0]\n    }\n  }\n\n  if (!opts.position.x) opts.position.x = 'middle'\n  if (!opts.position.y) opts.position.y = 'middle'\n\n  if (!opts.respectAnchorSpacing || typeof opts.respectAnchorSpacing === 'boolean') {\n    opts.respectAnchorSpacing = {\n      x: opts.respectAnchorSpacing,\n      y: opts.respectAnchorSpacing\n    }\n  }\n\n  if (!opts.respectAnchorSpacing.x) opts.respectAnchorSpacing.x = false\n  if (!opts.respectAnchorSpacing.y) opts.respectAnchorSpacing.y = false\n\n  return opts\n}\n\nminitaur.set = (modals, options, value) => {\n  modals = minitaur.getModals(modals, true)\n\n  if (typeof options === 'string') {\n    options = { [options]: value }\n  }\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (minitaurDebug) console.log('minitaur.set (#' + modal.id + '):', options)\n      modal.minitaur = minitaur.parseOptions(minitaur.mergeObjects(modal.minitaur, options || {}))\n    })(modals[i])\n  }\n}\n\nminitaur.setDimensions = (modal, options, final) => {\n  let opts = minitaur.get(modal, true, false)\n\n  opts = minitaur.mergeObjects(opts, options || {})\n\n  if (!opts.anchor.x) opts.anchor.x = opts.triggerElement || document.body\n  if (!opts.anchor.y) opts.anchor.y = opts.triggerElement || document.body\n\n  let anchorXElement = null\n  let anchorYElement = null\n\n  if (typeof opts.anchor.x === 'string') {\n    if (opts.anchor.x === 'viewport') {\n      anchorXElement = document.body\n    } else {\n      anchorXElement = document.querySelector(opts.anchor.x)\n    }\n  } else {\n    anchorXElement = opts.anchor.x\n  }\n\n  if (typeof opts.anchor.y === 'string') {\n    if (opts.anchor.y === 'viewport') {\n      anchorYElement = document.body\n    } else {\n      anchorYElement = document.querySelector(opts.anchor.y)\n    }\n  } else {\n    anchorYElement = opts.anchor.y\n  }\n\n  if (!(anchorXElement instanceof HTMLElement)) {\n    console.warn('(minitaur: #' + modal.id + ') Unable to find anchor.x:', anchorXElement)\n    anchorXElement = document.body\n  }\n\n  if (!(anchorYElement instanceof HTMLElement)) {\n    console.warn('(minitaur: #' + modal.id + ') Unable to find anchor.y:', anchorYElement)\n    anchorYElement = document.body\n  }\n\n  const modalClone = modal.cloneNode(true)\n\n  minitaur.setStyle(modalClone, minitaur.mergeObjects(opts.style || {}, opts.openStyle || {}, {\n    left: '0px',\n    opacity: '0',\n    position: 'absolute',\n    top: '0px',\n    transition: 'none'\n  }))\n\n  document.body.appendChild(modalClone)\n\n  const modalStyle = getComputedStyle(modalClone)\n  const anchorXRect = anchorXElement.getBoundingClientRect()\n  let anchorXLeft = anchorXRect.x + window.scrollX\n  let anchorXTop = anchorXRect.y + window.scrollY\n  let anchorXWidth = anchorXRect.width\n  let anchorXHeight = anchorXRect.height\n  let anchorYRect = anchorYElement.getBoundingClientRect()\n  let anchorYLeft = anchorYRect.x + window.scrollX\n  let anchorYTop = anchorYRect.y + window.scrollY\n  let anchorYWidth = anchorYRect.width\n  let anchorYHeight = anchorYRect.height\n  const modalMarginLeft = parseFloat(modalStyle.getPropertyValue('margin-left'))\n  const modalMarginTop = parseFloat(modalStyle.getPropertyValue('margin-top'))\n  const modalMarginRight = parseFloat(modalStyle.getPropertyValue('margin-right'))\n  const modalMarginBottom = parseFloat(modalStyle.getPropertyValue('margin-bottom'))\n  const modalWidth = modalClone.offsetWidth + modalMarginLeft + modalMarginRight\n  const modalHeight = modalClone.offsetHeight + modalMarginTop + modalMarginBottom\n  let left = 0\n  let top = 0\n  let width = parseFloat(modalStyle.getPropertyValue('width'))\n  let height = parseFloat(modalStyle.getPropertyValue('height'))\n  let boundaryX = document.body.clientWidth\n  let boundaryY = document.body.clientHeight\n  let adjustTopPositionFirst = false\n\n  document.body.removeChild(modalClone)\n\n  if (opts.anchor.x === 'viewport') {\n    anchorXLeft = window.scrollX\n    anchorXTop = window.scrollY\n    anchorXWidth = window.innerWidth\n    anchorXHeight = window.innerHeight\n    boundaryX = anchorXWidth + window.scrollX\n  }\n\n  if (opts.anchor.y === 'viewport') {\n    anchorYLeft = window.scrollX\n    anchorYTop = window.scrollY\n    anchorYWidth = window.innerWidth\n    anchorYHeight = window.innerHeight\n    boundaryY = anchorYHeight + window.scrollY\n  }\n\n  if (opts.takeover) {\n    anchorXLeft = 0 - parseInt(document.body.style.left || '0')\n    anchorXTop = 0 - parseInt(document.body.style.top || '0')\n    anchorYLeft = 0 - parseInt(document.body.style.left || '0')\n    anchorYTop = 0 - parseInt(document.body.style.top || '0')\n    boundaryX = anchorXLeft + window.innerWidth\n    boundaryY = anchorYTop + window.innerHeight\n  }\n\n  if (anchorXElement === document.body) {\n    switch (opts.position.x) {\n      case 'left':\n        opts.position.x = 'inner-left'\n        break\n      case 'right':\n        opts.position.x = 'inner-right'\n        break\n    }\n  }\n\n  if (anchorYElement === document.body) {\n    switch (opts.position.y) {\n      case 'top':\n        opts.position.y = 'inner-top'\n        break\n      case 'bottom':\n        opts.position.y = 'inner-bottom'\n        break\n    }\n  }\n\n  if (opts.respectAnchorSpacing.x) {\n    const anchorXStyle = getComputedStyle(anchorXElement)\n\n    switch (opts.position.x) {\n      case 'inner-left':\n        anchorXLeft += parseFloat(anchorXStyle.getPropertyValue('padding-left'))\n        break\n      case 'left':\n        anchorXLeft -= parseFloat(anchorXStyle.getPropertyValue('margin-left'))\n        break\n      case 'inner-right':\n        anchorXWidth -= parseFloat(anchorXStyle.getPropertyValue('padding-right'))\n        break\n      case 'right':\n        anchorXWidth += parseFloat(anchorXStyle.getPropertyValue('margin-right'))\n        break\n    }\n  }\n\n  if (opts.respectAnchorSpacing.y) {\n    const anchorYStyle = getComputedStyle(anchorYElement)\n\n    switch (opts.position.y) {\n      case 'inner-top':\n        anchorYTop += parseFloat(anchorYStyle.getPropertyValue('padding-top'))\n        break\n      case 'top':\n        anchorYTop -= parseFloat(anchorYStyle.getPropertyValue('margin-top'))\n        break\n      case 'inner-bottom':\n        anchorYHeight -= parseFloat(anchorYStyle.getPropertyValue('padding-bottom'))\n        break\n      case 'bottom':\n        anchorXHeight += parseFloat(anchorYStyle.getPropertyValue('margin-bottom'))\n        break\n    }\n  }\n\n  if (minitaurDebug) {\n    console.log('minitaur.setDimensions (#' + modal.id + '):', {\n      anxhorX: {\n        element: anchorXElement,\n        left: anchorXLeft,\n        top: anchorXTop,\n        width: anchorXWidth,\n        height: anchorXHeight,\n        rect: anchorXRect,\n        boundary: boundaryX\n      },\n      anxhorY: {\n        element: anchorYElement,\n        left: anchorYLeft,\n        top: anchorYTop,\n        width: anchorYWidth,\n        height: anchorYHeight,\n        rect: anchorYRect,\n        boundary: boundaryY\n      },\n      modal: {\n        height: modalHeight,\n        width: modalWidth\n      },\n      scroll: {\n        x: window.scrollX,\n        y: window.scrollY\n      }\n    })\n  }\n\n  switch (opts.position.x) {\n    case 'inner-left':\n      left = anchorXLeft\n      break\n    case 'left':\n      left = anchorXLeft - modalWidth - 1\n      break\n    case 'middle':\n      left = anchorXLeft + (anchorXWidth / 2) - (modalWidth / 2)\n      break\n    case 'inner-right':\n      left = anchorXLeft + anchorXWidth - modalWidth\n      break\n    case 'right':\n      left = anchorXLeft + anchorXWidth + 1\n      break\n    default:\n      if (typeof opts.position.x === 'string') {\n        if (opts.position.x[opts.position.x.length - 1] === '%') {\n          left = anchorXLeft + ((opts.position.x.substr(0, opts.position.x.length - 1) / 100) * anchorXWidth)\n        } else {\n          left = anchorXLeft + parseInt(opts.position.x)\n        }\n      } else if (Number.isFinite(opts.position.x)) {\n        left = anchorXLeft + opts.position.x\n      } else {\n        console.warn('minitaur (#' + modal.id + ') Invalid position.x value:', opts.position.x)\n        return false\n      }\n  }\n\n  switch (opts.position.y) {\n    case 'inner-top':\n      top = anchorYTop\n      break\n    case 'top':\n      top = anchorYTop - modalHeight - 1\n      break\n    case 'middle':\n      top = anchorYTop + (anchorYHeight / 2) - (modalHeight / 2)\n      break\n    case 'inner-bottom':\n      top = anchorYTop + anchorYHeight - modalHeight\n      break\n    case 'bottom':\n      top = anchorYTop + anchorYHeight + 1\n      break\n    default:\n      if (typeof opts.position.y === 'string') {\n        if (opts.position.y[opts.position.y.length - 1] === '%') {\n          top = anchorYTop + ((opts.position.y.substr(0, opts.position.y.length - 1) / 100) * anchorYHeight)\n        } else {\n          top = anchorYTop + parseInt(opts.position.y)\n        }\n      } else if (Number.isFinite(opts.position.y)) {\n        top = anchorYTop + opts.position.y\n      } else {\n        console.warn('minitaur (#' + modal.id + ') Invalid position.y value:', opts.position.y)\n        return false\n      }\n  }\n\n  if (opts.stayInBounds) {\n    if ((left + modalWidth) >= boundaryX) {\n      left = boundaryX - modalWidth\n    }\n\n    if (left < 0) {\n      left = 0\n    }\n\n    if ((top + modalHeight) >= boundaryY) {\n      top = boundaryY - modalHeight\n      adjustTopPositionFirst = true\n    }\n\n    if (top < 0) {\n      top = 0\n      adjustTopPositionFirst = true\n    }\n\n    if (\n      opts.position.x === 'left' ||\n      opts.position.x === 'right' ||\n      opts.position.y === 'top' ||\n      opts.position.y === 'bottom'\n    ) {\n      let anchorXOverlap = false\n      let anchorYOverlap = false\n\n      if (anchorXElement !== document.body) {\n        let anchorXLeftOverlap = (\n          (left >= anchorXLeft && left < (anchorXLeft + anchorXWidth)) ||\n          (left < anchorXLeft && (left + modalWidth) >= anchorXLeft)\n        )\n\n        let anchorXTopOverlap = (\n          (top >= anchorXTop && top < (anchorXTop + anchorXHeight)) ||\n          (top < anchorXTop && (top + modalHeight) >= anchorXTop)\n        )\n\n        anchorXOverlap = anchorXLeftOverlap && anchorXTopOverlap\n      }\n\n      if (anchorYElement !== document.body) {\n        let anchorYLeftOverlap = (\n          (left >= anchorYLeft && left < (anchorYLeft + anchorYWidth)) ||\n          (left < anchorYLeft && (left + modalWidth) >= anchorYLeft)\n        )\n\n        let anchorYTopOverlap = (\n          (top >= anchorYTop && top < (anchorYTop + anchorYHeight)) ||\n          (top < anchorYTop && (top + modalHeight) >= anchorYTop)\n        )\n\n        anchorYOverlap = anchorYLeftOverlap && anchorYTopOverlap\n      }\n\n      if (anchorXOverlap || anchorYOverlap) {\n        if (!adjustTopPositionFirst) {\n          if (opts.position.x === 'left') {\n            if (!final) {\n              opts.position.x = 'right'\n              return minitaur.setDimensions(modal, opts, true)\n            }\n          } else {\n            opts.position.x = 'left'\n            return minitaur.setDimensions(modal, opts, true)\n          }\n        } else {\n          if (opts.position.y === 'top') {\n            if (!final) {\n              opts.position.y = 'bottom'\n              return minitaur.setDimensions(modal, opts, true)\n            }\n          } else {\n            opts.position.y = 'top'\n            return minitaur.setDimensions(modal, opts, true)\n          }\n        }\n      }\n    }\n  }\n\n  minitaur.setStyle(modal, minitaur.mergeObjects({ zIndex: opts.takeover ? 99999 : null }, opts.style || {}, opts.openStyle || {}, {\n    position: 'absolute',\n    left: left + 'px',\n    top: top + 'px',\n    width: width + 'px',\n    height: height + 'px'\n  }))\n\n  return true\n}\n\nminitaur.setStyle = (element, styles) => {\n  if (minitaurDebug) console.log('minitaur.setStyle (' + (element.id ? '#' + element.id : element.tagName) + '):', styles)\n\n  for (let property in styles) {\n    element.style[property] = styles[property]\n  }\n}\n\nminitaur.toggle = (modals, options) => {\n  modals = minitaur.getModals(modals, true)\n\n  for (let i = 0; i < modals.length; i++) {\n    (function (modal) {\n      if (minitaurDebug) console.log('minitaur.toggle (#' + modal.id + '):', options)\n\n      if (modal.minitaur.isOpen) {\n        modal.minitaur.close(options)\n      } else {\n        modal.minitaur.open(options)\n      }\n    })(modals[i])\n  }\n}\n\nminitaur.triggerEvent = (e) => {\n  const actions = ['close', 'open', 'toggle']\n  let triggerElement = e.currentTarget\n  const opts = minitaur.mergeObjects(minitaur.parseAttributes(triggerElement.dataset), { triggerElement: triggerElement })\n\n  for (let i = 0; i < actions.length; i++) {\n    let action = actions[i]\n    let targetElements = triggerElement.getAttribute('data-minitaur-' + action)\n\n    if (targetElements) {\n      if (minitaurDebug) console.log('minitaur.triggerEvent:', targetElements, opts)\n      minitaur[action](targetElements, opts)\n    }\n  }\n}\n\nexport default minitaur\n"],"names":["minitaurDebug","window","minitaur","mount","options","elements","modals","constructor","Object","mergeObjects","defaultOptions","document","querySelectorAll","HTMLElement","createElement","getModals","length","i","modal","beforeInit","modalCount","funcs","close","get","parseBreakpoints","kill","putBack","open","set","value","toggle","opts","parseOptions","parseAttributes","dataset","isOpen","parentNode","body","originalElement","cloneNode","originalElementIndex","Array","prototype","indexOf","call","childNodes","originalElementParent","removeChild","setAttribute","id","console","log","class","c","classList","add","setStyle","style","closeStyle","initiateTriggers","appendChild","opened","afterInit","push","initiated","addEventListener","documentClick","documentResize","documentScroll","afterClose","afterOpen","anchor","backdropClass","backdropClosingStyle","backdropOpeningStyle","backdropStyle","backgroundColor","beforeClose","beforeOpen","breakpoints","closeClass","closeDuration","closingClass","closingStyle","closeOnFocusOut","display","visibility","content","openClass","openDuration","openingClass","openingStyle","openStyle","parameters","position","respectAnchorSpacing","stayInBounds","takeover","triggers","clearTimers","resizeTimer","clearTimeout","closeDurationTimer","openDurationTimer","remove","backdrop","removeAttribute","querySelector","scrollX","parseInt","left","scrollY","top","height","width","scrollTo","setTimeout","dispatchEvent","Event","bubbles","e","element","target","closeModals","minitaurIgnore","contains","x","y","verify","breakpointOpts","breakpoint","documentElement","clientWidth","verifiedElements","warn","actions","action","events","reduce","validTriggers","trigger","isArray","t","includes","triggerElement","triggerElementTargets","getAttribute","triggerElementEvents","split","join","te","triggerEvent","a","triggerElements","ae","triggerEvents","triggerTargets","aee","insertBefore","nullActions","triggerElementTargetIndex","splice","removeEventListener","isObject","obj","objects","prev","keys","forEach","key","pVal","oVal","filter","index","array","innerHTML","parameter","replace","RegExp","right","bottom","zIndex","clientHeight","setDimensions","data","keyPrefix","arrayParameters","objectParameters","deepObjectParameters","validParameters","concat","substring","toLowerCase","property","charAt","propSet","o","objKey","objProp","objPropKey","match","final","anchorXElement","anchorYElement","modalClone","opacity","transition","modalStyle","getComputedStyle","anchorXRect","getBoundingClientRect","anchorXLeft","anchorXTop","anchorXWidth","anchorXHeight","anchorYRect","anchorYLeft","anchorYTop","anchorYWidth","anchorYHeight","modalMarginLeft","parseFloat","getPropertyValue","modalMarginTop","modalMarginRight","modalMarginBottom","modalWidth","offsetWidth","modalHeight","offsetHeight","boundaryX","boundaryY","adjustTopPositionFirst","innerWidth","innerHeight","anchorXStyle","anchorYStyle","anxhorX","rect","boundary","anxhorY","scroll","substr","Number","isFinite","anchorXOverlap","anchorYOverlap","anchorXLeftOverlap","anchorXTopOverlap","anchorYLeftOverlap","anchorYTopOverlap","styles","tagName","currentTarget","targetElements"],"mappings":"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"}